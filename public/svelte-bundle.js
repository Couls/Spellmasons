var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function u(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e){t.appendChild(e)}function r(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function s(t){return document.createElement(t)}function a(t){return document.createTextNode(t)}function d(){return a(" ")}function p(){return a("")}function f(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){t.value=null==e?"":e}function v(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}let w;function g(t){w=t}function y(){if(!w)throw new Error("Function called outside component initialization");return w}const $=[],b=[],k=[],R=[],x=Promise.resolve();let C=!1;function O(t){k.push(t)}const P=new Set;let N=0;function S(){const t=w;do{for(;N<$.length;){const t=$[N];N++,g(t),_(t.$$)}for(g(null),$.length=0,N=0;b.length;)b.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];P.has(e)||(P.add(e),e())}k.length=0}while($.length);for(;R.length;)R.pop()();C=!1,P.clear(),g(t)}function _(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const I=new Set;let M;function z(){M={r:0,c:[],p:M}}function E(){M.r||o(M.c),M=M.p}function G(t,e){t&&t.i&&(I.delete(t),t.i(e))}function T(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),M.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function A(t,e){const n=e.token={};function o(t,o,u,c){if(e.token!==n)return;e.resolved=c;let i=e.ctx;void 0!==u&&(i=i.slice(),i[u]=c);const r=t&&(e.current=t)(i);let l=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(z(),T(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),E())})):e.block.d(1),r.c(),G(r,1),r.m(e.mount(),e.anchor),l=!0),e.block=r,e.blocks&&(e.blocks[o]=r),l&&S()}if((u=t)&&"object"==typeof u&&"function"==typeof u.then){const n=y();if(t.then((t=>{g(n),o(e.then,1,e.value,t),g(null)}),(t=>{if(g(n),o(e.catch,2,e.error,t),g(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}var u}function L(t){t&&t.c()}function U(t,n,c,i){const{fragment:r,on_mount:l,on_destroy:s,after_update:a}=t.$$;r&&r.m(n,c),i||O((()=>{const n=l.map(e).filter(u);s?s.push(...n):o(n),t.$$.on_mount=[]})),a.forEach(O)}function j(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function F(t,e){-1===t.$$.dirty[0]&&($.push(t),C||(C=!0,x.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,u,c,i,r,s,a,d=[-1]){const p=w;g(e);const f=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u.context||(p?p.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:u.target||p.$$.root};a&&a(f.root);let m=!1;if(f.ctx=c?c(e,u.props||{},((t,n,...o)=>{const u=o.length?o[0]:n;return f.ctx&&r(f.ctx[t],f.ctx[t]=u)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](u),m&&F(e,t)),n})):[],f.update(),m=!0,o(f.before_update),f.fragment=!!i&&i(f.ctx),u.target){if(u.hydrate){const t=function(t){return Array.from(t.childNodes)}(u.target);f.fragment&&f.fragment.l(t),t.forEach(l)}else f.fragment&&f.fragment.c();u.intro&&G(e.$$.fragment),U(e,u.target,u.anchor,u.customElement),S()}g(p)}class V{$destroy(){j(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function B(e){let n,u,c,p,h,v,w,g,y,$,b,k,R;return{c(){n=s("button"),n.textContent="ðŸ ” Back",u=d(),c=s("div"),p=a("Total Volume:\r\n    "),h=s("input"),v=a("\r\n    Music Volume:\r\n    "),w=s("input"),g=a("\r\n    Sound Effects Volume:\r\n    "),y=s("input"),$=d(),b=s("button"),b.textContent="Re-prompt Cookie Consent",m(n,"type","button"),m(h,"type","range"),h.value=100*window.volume,m(h,"min","0"),m(h,"max","100"),m(w,"type","range"),w.value=100*window.volumeMusic,m(w,"min","0"),m(w,"max","100"),m(y,"type","range"),y.value=100*window.volumeGame,m(y,"min","0"),m(y,"max","100"),m(b,"type","button")},m(t,o){r(t,n,o),r(t,u,o),r(t,c,o),i(c,p),i(c,h),i(c,v),i(c,w),i(c,g),i(c,y),r(t,$,o),r(t,b,o),k||(R=[f(n,"click",e[2]),f(h,"input",H),f(w,"input",q),f(y,"input",D),f(b,"click",e[3])],k=!0)},p:t,i:t,o:t,d(t){t&&l(n),t&&l(u),t&&l(c),t&&l($),t&&l(b),k=!1,o(R)}}}function H(t){window.changeVolume(t.target.value/100)}function q(t){window.changeVolumeMusic(t.target.value/100)}function D(t){window.changeVolumeGame(t.target.value/100)}function J(t,e,n){let{setRoute:o}=e,{lastRoute:u}=e;return t.$$set=t=>{"setRoute"in t&&n(0,o=t.setRoute),"lastRoute"in t&&n(1,u=t.lastRoute)},[o,u,()=>o(u),()=>window.cookieConsentPopup(!0)]}class Q extends V{constructor(t){super(),Y(this,t,J,B,c,{setRoute:0,lastRoute:1})}}function K(t){let e,n,o,u={ctx:t,current:null,token:null,hasCatch:!0,pending:ct,then:Z,catch:X};return A(window.setupPixiPromise,u),{c(){e=s("div"),n=d(),o=p(),u.block.c(),m(e,"id","websocket-pie-connection-status")},m(t,c){r(t,e,c),r(t,n,c),r(t,o,c),u.block.m(t,u.anchor=c),u.mount=()=>o.parentNode,u.anchor=o},p(e,n){!function(t,e,n){const o=e.slice(),{resolved:u}=t;t.current===t.then&&(o[t.value]=u),t.current===t.catch&&(o[t.error]=u),t.block.p(o,n)}(u,t=e,n)},d(t){t&&l(e),t&&l(n),t&&l(o),u.block.d(t),u.token=null,u=null}}}function W(e){let n,u,c,a,p,h,v,w,g,y;return{c(){n=s("div"),u=s("button"),u.textContent="Resume Game",c=d(),a=s("button"),a.textContent="Options",p=d(),h=s("button"),h.textContent="Player Appearance",v=d(),w=s("button"),w.textContent="Quit to Main Menu",m(u,"class","svelte-7zu9yh"),m(a,"class","svelte-7zu9yh"),m(h,"class","svelte-7zu9yh"),m(w,"class","svelte-7zu9yh"),m(n,"class","list svelte-7zu9yh")},m(t,o){r(t,n,o),i(n,u),i(n,c),i(n,a),i(n,p),i(n,h),i(n,v),i(n,w),g||(y=[f(u,"click",rt),f(a,"click",e[16]),f(h,"click",e[17]),f(w,"click",e[14])],g=!0)},p:t,d(t){t&&l(n),g=!1,o(y)}}}function X(e){let n;return{c(){n=s("p"),n.textContent="Something went wrong loading assets",v(n,"color","red")},m(t,e){r(t,n,e)},p:t,d(t){t&&l(n)}}}function Z(t){let e,n,u,c,a,h,v,w,g,y,$,b,k=!1===t[6]&&tt(t);return{c(){e=s("div"),n=s("button"),n.textContent="New Run",u=d(),c=s("button"),c.textContent="Options",a=d(),h=s("button"),h.textContent="Multiplayer",v=d(),w=s("br"),g=d(),k&&k.c(),y=p(),m(n,"class","svelte-7zu9yh"),m(c,"class","svelte-7zu9yh"),m(h,"class","svelte-7zu9yh"),m(e,"class","list svelte-7zu9yh")},m(o,l){r(o,e,l),i(e,n),i(e,u),i(e,c),i(e,a),i(e,h),r(o,v,l),r(o,w,l),r(o,g,l),k&&k.m(o,l),r(o,y,l),$||(b=[f(n,"click",t[10]),f(c,"click",t[18]),f(h,"click",t[11])],$=!0)},p(t,e){!1===t[6]?k?k.p(t,e):(k=tt(t),k.c(),k.m(y.parentNode,y)):k&&(k.d(1),k=null)},d(t){t&&l(e),t&&l(v),t&&l(w),t&&l(g),k&&k.d(t),t&&l(y),$=!1,o(b)}}}function tt(t){let e,n,u,c,m,v,w,g,y,$,b,k,R,x,C,O=t[4]&&et(),P=t[9]&&nt(t);return{c(){e=a("Server Url\r\n            "),n=s("div"),u=s("input"),c=d(),m=s("button"),v=a("Connect"),w=d(),g=s("button"),y=a("Disconnect"),b=d(),O&&O.c(),k=d(),P&&P.c(),R=p(),m.disabled=t[9],g.disabled=$=!t[9]},m(o,l){r(o,e,l),r(o,n,l),i(n,u),h(u,t[7]),i(n,c),i(n,m),i(m,v),i(n,w),i(n,g),i(g,y),r(o,b,l),O&&O.m(o,l),r(o,k,l),P&&P.m(o,l),r(o,R,l),x||(C=[f(u,"input",t[19]),f(u,"keypress",t[20]),f(m,"click",t[12]),f(g,"click",t[13])],x=!0)},p(t,e){128&e&&u.value!==t[7]&&h(u,t[7]),512&e&&(m.disabled=t[9]),512&e&&$!==($=!t[9])&&(g.disabled=$),t[4]?O||(O=et(),O.c(),O.m(k.parentNode,k)):O&&(O.d(1),O=null),t[9]?P?P.p(t,e):(P=nt(t),P.c(),P.m(R.parentNode,R)):P&&(P.d(1),P=null)},d(t){t&&l(e),t&&l(n),t&&l(b),O&&O.d(t),t&&l(k),P&&P.d(t),t&&l(R),x=!1,o(C)}}}function et(t){let e,n;return{c(){e=a("Connecting...\r\n                "),n=s("div"),n.innerHTML='<div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div>',m(n,"class","lds-ellipsis svelte-7zu9yh")},m(t,o){r(t,e,o),r(t,n,o)},d(t){t&&l(e),t&&l(n)}}}function nt(t){let e,n,u,c,i,a,m;function v(t,e){return t[5]?ut:ot}let w=v(t),g=w(t);return{c(){e=s("p"),e.textContent="Game name",n=d(),u=s("input"),c=d(),g.c(),i=p()},m(o,l){r(o,e,l),r(o,n,l),r(o,u,l),h(u,t[8]),r(o,c,l),g.m(o,l),r(o,i,l),a||(m=[f(u,"input",t[21]),f(u,"keypress",t[22])],a=!0)},p(t,e){256&e&&u.value!==t[8]&&h(u,t[8]),w===(w=v(t))&&g?g.p(t,e):(g.d(1),g=w(t),g&&(g.c(),g.m(i.parentNode,i)))},d(t){t&&l(e),t&&l(n),t&&l(u),t&&l(c),g.d(t),t&&l(i),a=!1,o(m)}}}function ot(e){let n,u,c,a,p,m;return{c(){n=s("div"),u=s("button"),u.textContent="Host",c=d(),a=s("button"),a.textContent="Join",v(n,"display","flex")},m(t,o){r(t,n,o),i(n,u),i(n,c),i(n,a),p||(m=[f(u,"click",e[15]),f(a,"click",e[15])],p=!0)},p:t,d(t){t&&l(n),p=!1,o(m)}}}function ut(e){let n,o;return{c(){n=a("Joining...\r\n                    "),o=s("div"),o.innerHTML='<div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div>',m(o,"class","lds-ellipsis svelte-7zu9yh")},m(t,e){r(t,n,e),r(t,o,e)},p:t,d(t){t&&l(n),t&&l(o)}}}function ct(e){let n;return{c(){n=a("loading assets...")},m(t,e){r(t,n,e)},p:t,d(t){t&&l(n)}}}function it(e){let n;function o(t,e){return t[3]?W:K}let u=o(e),c=u(e);return{c(){c.c(),n=p()},m(t,e){c.m(t,e),r(t,n,e)},p(t,[e]){u===(u=o(t))&&c?c.p(t,e):(c.d(1),c=u(t),c&&(c.c(),c.m(n.parentNode,n)))},i:t,o:t,d(t){c.d(t),t&&l(n)}}}function rt(){window.closeMenu()}function lt(t,e,n){let o,{setRoute:u}=e,{OPTIONS:c}=e,{PLAYER_CONFIG:i}=e,{inGame:r}=e,l=!1,s=!1;function a(){window.playMusic(),o&&w(),n(6,o=!1)}let d,p=new URLSearchParams(location.search),f=p.get("pieUrl"),m=p.get("game");function h(){n(9,d=window.isConnected()),n(4,l=!1)}function v(){if(f){console.log("Menu: Connect to server",f),n(4,l=!0);const t=new URL(location.href);return t.searchParams.set("pieUrl",f),window.history.pushState(null,null,t),window.connect_to_wsPie_server(f).catch(console.error).then(h)}return Promise.reject("No wsUrl defined to connect to")}function w(){window.pieDisconnect().then(h)}function g(){m?window.isConnected()?(console.log("Menu: Connect to game name",m),n(5,s=!0),window.joinRoom({name:m}).then((()=>{const t=new URL(location.href);t.searchParams.set("game",m),window.history.pushState(null,null,t)})).catch((t=>{console.error("Could not join room",t)})).then((()=>{n(5,s=!1)}))):console.error("Cannot join room until pieClient is connected to a pieServer"):console.log("Cannot join game until a gameName is provided")}window.tryAutoConnect=()=>{f&&(console.log("Menu: Start auto connect"),a(),v())};return t.$$set=t=>{"setRoute"in t&&n(0,u=t.setRoute),"OPTIONS"in t&&n(1,c=t.OPTIONS),"PLAYER_CONFIG"in t&&n(2,i=t.PLAYER_CONFIG),"inGame"in t&&n(3,r=t.inGame)},[u,c,i,r,l,s,o,f,m,d,function(){window.playMusic(),n(6,o=!0),window.startSingleplayer().then((()=>{h()}))},a,v,w,function(){if(confirm("Are you sure you want to quit to Main Menu?")){const t=new URL(location.href);t.searchParams.delete("game"),t.searchParams.delete("pieUrl"),window.history.pushState(null,null,t),window.exitCurrentGame().then(h)}},g,()=>u(c),()=>u(i),()=>u(c),function(){f=this.value,n(7,f)},t=>{"Enter"==t.key&&v()},function(){m=this.value,n(8,m)},t=>{"Enter"==t.key&&g()}]}class st extends V{constructor(t){super(),Y(this,t,lt,it,c,{setRoute:0,OPTIONS:1,PLAYER_CONFIG:2,inGame:3})}}function at(e){let n,u,c,a,p,v,w,g,y,$,b,k;return{c(){n=s("button"),n.textContent="ðŸ ” Back",u=d(),c=s("div"),a=s("label"),a.textContent="Robe Color",p=d(),v=s("input"),w=d(),g=s("label"),g.textContent="Player Name",y=d(),$=s("input"),m(n,"type","button"),m(a,"for","robe"),m(v,"type","color"),m(v,"name","robe"),m(g,"for","player-name"),m($,"type","text"),m($,"name","player-name")},m(t,o){r(t,n,o),r(t,u,o),r(t,c,o),i(c,a),i(c,p),i(c,v),h(v,e[3]),i(c,w),i(c,g),i(c,y),i(c,$),h($,e[2]),b||(k=[f(n,"click",e[5]),f(v,"input",e[6]),f(v,"blur",e[7]),f($,"input",e[8]),f($,"input",e[9])],b=!0)},p(t,[e]){8&e&&h(v,t[3]),4&e&&$.value!==t[2]&&h($,t[2])},i:t,o:t,d(t){t&&l(n),t&&l(u),t&&l(c),b=!1,o(k)}}}function dt(t,e,n){let{setRoute:o}=e,{lastRoute:u}=e,c=localStorage.getItem("player-name"),i=`#${parseInt(localStorage.getItem("player-color")).toString(16)}`;const r=t=>parseInt(t.slice(1),16);return t.$$set=t=>{"setRoute"in t&&n(0,o=t.setRoute),"lastRoute"in t&&n(1,u=t.lastRoute)},[o,u,c,i,r,()=>o(u),function(){i=this.value,n(3,i)},()=>{window.configPlayer({color:r(i),name:c})},function(){c=this.value,n(2,c)},()=>{window.configPlayer({color:r(i),name:c})}]}class pt extends V{constructor(t){super(),Y(this,t,dt,at,c,{setRoute:0,lastRoute:1})}}function ft(e){let n,u,c,a,p,h,v,w;return{c(){n=s("div"),u=s("button"),u.textContent="Resume Tutorial",c=d(),a=s("button"),a.textContent="Options",p=d(),h=s("button"),h.textContent="Skip Tutorial",m(n,"class","list")},m(t,o){r(t,n,o),i(n,u),i(n,c),i(n,a),i(n,p),i(n,h),v||(w=[f(u,"click",ht),f(a,"click",e[2]),f(h,"click",mt)],v=!0)},p:t,i:t,o:t,d(t){t&&l(n),v=!1,o(w)}}}function mt(){confirm("Are you sure you want to skip the tutorial?")&&(window.skipTutorial(),window.exitCurrentGame())}function ht(){window.closeMenu()}function vt(t,e,n){let{OPTIONS:o}=e,{setRoute:u}=e;return t.$$set=t=>{"OPTIONS"in t&&n(0,o=t.OPTIONS),"setRoute"in t&&n(1,u=t.setRoute)},[o,u,()=>u(o)]}class wt extends V{constructor(t){super(),Y(this,t,vt,ft,c,{OPTIONS:0,setRoute:1})}}function gt(e){let n,o;return n=new wt({props:{setRoute:e[3],OPTIONS:Rt}}),{c(){L(n.$$.fragment)},m(t,e){U(n,t,e),o=!0},p:t,i(t){o||(G(n.$$.fragment,t),o=!0)},o(t){T(n.$$.fragment,t),o=!1},d(t){j(n,t)}}}function yt(t){let e,n;return e=new Q({props:{setRoute:t[3],lastRoute:t[0]}}),{c(){L(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.lastRoute=t[0]),e.$set(o)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function $t(t){let e,n;return e=new pt({props:{setRoute:t[3],lastRoute:t[0]}}),{c(){L(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.lastRoute=t[0]),e.$set(o)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function bt(t){let e,n;return e=new st({props:{setRoute:t[3],PLAYER_CONFIG:xt,OPTIONS:Rt,inGame:t[2]}}),{c(){L(e.$$.fragment)},m(t,o){U(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.inGame=t[2]),e.$set(o)},i(t){n||(G(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function kt(t){let e,n,o,u;const c=[bt,$t,yt,gt],i=[];function s(t,e){return t[1]==Ct?0:t[1]==xt?1:t[1]==Rt?2:t[1]==Ot?3:-1}return~(e=s(t))&&(n=i[e]=c[e](t)),{c(){n&&n.c(),o=p()},m(t,n){~e&&i[e].m(t,n),r(t,o,n),u=!0},p(t,[u]){let r=e;e=s(t),e===r?~e&&i[e].p(t,u):(n&&(z(),T(i[r],1,1,(()=>{i[r]=null})),E()),~e?(n=i[e],n?n.p(t,u):(n=i[e]=c[e](t),n.c()),G(n,1),n.m(o.parentNode,o)):n=null)},i(t){u||(G(n),u=!0)},o(t){T(n),u=!1},d(t){~e&&i[e].d(t),t&&l(o)}}}const Rt="OPTIONS",xt="PLAYER_CONFIG",Ct="PLAY",Ot="TUTORIAL";function Pt(t,e,n){let o,u;console.log("Menu: Svelte menu is running");let c=!1;function i(t){console.log("Menu: Route:",t),n(0,o=u),n(1,u=t),window.updateInGameMenuStatus()}return window.updateInGameMenuStatus=()=>{n(2,c=void 0!==window.player)},i(Ct),window.setMenu=i,[o,u,c,i]}return new class extends V{constructor(t){super(),Y(this,t,Pt,kt,c,{})}}({target:document.getElementById("menu-inner")||document.body,props:{}})}();
//# sourceMappingURL=svelte-bundle.js.map
