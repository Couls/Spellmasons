var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function u(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function c(t,n){t.appendChild(n)}function r(t,n,e){t.insertBefore(n,e||null)}function l(t){t.parentNode.removeChild(t)}function s(t){return document.createElement(t)}function a(t){return document.createTextNode(t)}function d(){return a(" ")}function f(){return a("")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function m(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function h(t,n){t.value=null==n?"":n}function w(t,n,e,o){null===e?t.style.removeProperty(n):t.style.setProperty(n,e,o?"important":"")}let v;function g(t){v=t}function $(){if(!v)throw new Error("Function called outside component initialization");return v}const y=[],b=[],k=[],x=[],C=Promise.resolve();let R=!1;function O(t){k.push(t)}const S=new Set;let P=0;function M(){const t=v;do{for(;P<y.length;){const t=y[P];P++,g(t),N(t.$$)}for(g(null),y.length=0,P=0;b.length;)b.pop()();for(let t=0;t<k.length;t+=1){const n=k[t];S.has(n)||(S.add(n),n())}k.length=0}while(y.length);for(;x.length;)x.pop()();R=!1,S.clear(),g(t)}function N(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(O)}}const _=new Set;let T;function z(){T={r:0,c:[],p:T}}function I(){T.r||o(T.c),T=T.p}function E(t,n){t&&t.i&&(_.delete(t),t.i(n))}function G(t,n,e,o){if(t&&t.o){if(_.has(t))return;_.add(t),T.c.push((()=>{_.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}}function L(t,n){const e=n.token={};function o(t,o,u,i){if(n.token!==e)return;n.resolved=i;let c=n.ctx;void 0!==u&&(c=c.slice(),c[u]=i);const r=t&&(n.current=t)(c);let l=!1;n.block&&(n.blocks?n.blocks.forEach(((t,e)=>{e!==o&&t&&(z(),G(t,1,1,(()=>{n.blocks[e]===t&&(n.blocks[e]=null)})),I())})):n.block.d(1),r.c(),E(r,1),r.m(n.mount(),n.anchor),l=!0),n.block=r,n.blocks&&(n.blocks[o]=r),l&&M()}if((u=t)&&"object"==typeof u&&"function"==typeof u.then){const e=$();if(t.then((t=>{g(e),o(n.then,1,n.value,t),g(null)}),(t=>{if(g(e),o(n.catch,2,n.error,t),g(null),!n.hasCatch)throw t})),n.current!==n.pending)return o(n.pending,0),!0}else{if(n.current!==n.then)return o(n.then,1,n.value,t),!0;n.resolved=t}var u}function U(t){t&&t.c()}function j(t,e,i,c){const{fragment:r,on_mount:l,on_destroy:s,after_update:a}=t.$$;r&&r.m(e,i),c||O((()=>{const e=l.map(n).filter(u);s?s.push(...e):o(e),t.$$.on_mount=[]})),a.forEach(O)}function A(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function V(t,n){-1===t.$$.dirty[0]&&(y.push(t),R||(R=!0,C.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function B(n,u,i,c,r,s,a,d=[-1]){const f=v;g(n);const p=n.$$={fragment:null,ctx:null,props:s,update:t,not_equal:r,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u.context||(f?f.$$.context:[])),callbacks:e(),dirty:d,skip_bound:!1,root:u.target||f.$$.root};a&&a(p.root);let m=!1;if(p.ctx=i?i(n,u.props||{},((t,e,...o)=>{const u=o.length?o[0]:e;return p.ctx&&r(p.ctx[t],p.ctx[t]=u)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](u),m&&V(n,t)),e})):[],p.update(),m=!0,o(p.before_update),p.fragment=!!c&&c(p.ctx),u.target){if(u.hydrate){const t=function(t){return Array.from(t.childNodes)}(u.target);p.fragment&&p.fragment.l(t),t.forEach(l)}else p.fragment&&p.fragment.c();u.intro&&E(n.$$.fragment),j(n,u.target,u.anchor,u.customElement),M()}g(f)}class H{$destroy(){A(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function q(n){let e,u,i,f,h,w,v,g,$,y,b,k,x;return{c(){e=s("button"),e.textContent="ðŸ ” Back",u=d(),i=s("div"),f=a("Total Volume:\r\n    "),h=s("input"),w=a("\r\n    Music Volume:\r\n    "),v=s("input"),g=a("\r\n    Sound Effects Volume:\r\n    "),$=s("input"),y=d(),b=s("button"),b.textContent="Re-prompt Cookie Consent",m(e,"type","button"),m(h,"type","range"),h.value=100*window.volume,m(h,"min","0"),m(h,"max","100"),m(v,"type","range"),v.value=100*window.volumeMusic,m(v,"min","0"),m(v,"max","100"),m($,"type","range"),$.value=100*window.volumeGame,m($,"min","0"),m($,"max","100"),m(b,"type","button")},m(t,o){r(t,e,o),r(t,u,o),r(t,i,o),c(i,f),c(i,h),c(i,w),c(i,v),c(i,g),c(i,$),r(t,y,o),r(t,b,o),k||(x=[p(e,"click",n[2]),p(h,"input",J),p(v,"input",D),p($,"input",F),p(b,"click",n[3])],k=!0)},p:t,i:t,o:t,d(t){t&&l(e),t&&l(u),t&&l(i),t&&l(y),t&&l(b),k=!1,o(x)}}}function J(t){window.changeVolume(t.target.value/100)}function D(t){window.changeVolumeMusic(t.target.value/100)}function F(t){window.changeVolumeGame(t.target.value/100)}function Q(t,n,e){let{setRoute:o}=n,{lastRoute:u}=n;return t.$$set=t=>{"setRoute"in t&&e(0,o=t.setRoute),"lastRoute"in t&&e(1,u=t.lastRoute)},[o,u,()=>o(u),()=>window.cookieConsentPopup(!0)]}class Y extends H{constructor(t){super(),B(this,t,Q,q,i,{setRoute:0,lastRoute:1})}}function K(t){let n,e,o,u={ctx:t,current:null,token:null,hasCatch:!0,pending:it,then:Z,catch:X};return L(window.setupPixiPromise,u),{c(){n=s("div"),e=d(),o=f(),u.block.c(),m(n,"id","websocket-pie-connection-status")},m(t,i){r(t,n,i),r(t,e,i),r(t,o,i),u.block.m(t,u.anchor=i),u.mount=()=>o.parentNode,u.anchor=o},p(n,e){!function(t,n,e){const o=n.slice(),{resolved:u}=t;t.current===t.then&&(o[t.value]=u),t.current===t.catch&&(o[t.error]=u),t.block.p(o,e)}(u,t=n,e)},d(t){t&&l(n),t&&l(e),t&&l(o),u.block.d(t),u.token=null,u=null}}}function W(n){let e,u,i,a,f,h,w,v;return{c(){e=s("div"),u=s("button"),u.textContent="Resume Game",i=d(),a=s("button"),a.textContent="Options",f=d(),h=s("button"),h.textContent="Quit to Main Menu",m(u,"class","svelte-7zu9yh"),m(a,"class","svelte-7zu9yh"),m(h,"class","svelte-7zu9yh"),m(e,"class","list svelte-7zu9yh")},m(t,o){r(t,e,o),c(e,u),c(e,i),c(e,a),c(e,f),c(e,h),w||(v=[p(u,"click",rt),p(a,"click",n[15]),p(h,"click",n[13])],w=!0)},p:t,d(t){t&&l(e),w=!1,o(v)}}}function X(n){let e;return{c(){e=s("p"),e.textContent="Something went wrong loading assets",w(e,"color","red")},m(t,n){r(t,e,n)},p:t,d(t){t&&l(e)}}}function Z(t){let n,e,u,i,c,a,m,h,w,v=!1===t[5]&&tt(t);return{c(){n=s("button"),n.textContent="Singleplayer",e=d(),u=s("button"),u.textContent="Multiplayer",i=d(),c=s("br"),a=d(),v&&v.c(),m=f()},m(o,l){r(o,n,l),r(o,e,l),r(o,u,l),r(o,i,l),r(o,c,l),r(o,a,l),v&&v.m(o,l),r(o,m,l),h||(w=[p(n,"click",t[9]),p(u,"click",t[10])],h=!0)},p(t,n){!1===t[5]?v?v.p(t,n):(v=tt(t),v.c(),v.m(m.parentNode,m)):v&&(v.d(1),v=null)},d(t){t&&l(n),t&&l(e),t&&l(u),t&&l(i),t&&l(c),t&&l(a),v&&v.d(t),t&&l(m),h=!1,o(w)}}}function tt(t){let n,e,u,i,m,w,v,g,$,y,b,k,x,C,R,O=t[3]&&nt(),S=t[8]&&et(t);return{c(){n=a("Server Url\r\n            "),e=s("div"),u=s("input"),i=d(),m=s("button"),w=a("Connect"),v=d(),g=s("button"),$=a("Disconnect"),b=d(),O&&O.c(),k=d(),S&&S.c(),x=f(),m.disabled=t[8],g.disabled=y=!t[8]},m(o,l){r(o,n,l),r(o,e,l),c(e,u),h(u,t[6]),c(e,i),c(e,m),c(m,w),c(e,v),c(e,g),c(g,$),r(o,b,l),O&&O.m(o,l),r(o,k,l),S&&S.m(o,l),r(o,x,l),C||(R=[p(u,"input",t[16]),p(u,"keypress",t[17]),p(m,"click",t[11]),p(g,"click",t[12])],C=!0)},p(t,n){64&n&&u.value!==t[6]&&h(u,t[6]),256&n&&(m.disabled=t[8]),256&n&&y!==(y=!t[8])&&(g.disabled=y),t[3]?O||(O=nt(),O.c(),O.m(k.parentNode,k)):O&&(O.d(1),O=null),t[8]?S?S.p(t,n):(S=et(t),S.c(),S.m(x.parentNode,x)):S&&(S.d(1),S=null)},d(t){t&&l(n),t&&l(e),t&&l(b),O&&O.d(t),t&&l(k),S&&S.d(t),t&&l(x),C=!1,o(R)}}}function nt(t){let n,e;return{c(){n=a("Connecting...\r\n                "),e=s("div"),e.innerHTML='<div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div> \n                    <div class="svelte-7zu9yh"></div>',m(e,"class","lds-ellipsis svelte-7zu9yh")},m(t,o){r(t,n,o),r(t,e,o)},d(t){t&&l(n),t&&l(e)}}}function et(t){let n,e,u,i,c,a,m;function w(t,n){return t[4]?ut:ot}let v=w(t),g=v(t);return{c(){n=s("p"),n.textContent="Game name",e=d(),u=s("input"),i=d(),g.c(),c=f()},m(o,l){r(o,n,l),r(o,e,l),r(o,u,l),h(u,t[7]),r(o,i,l),g.m(o,l),r(o,c,l),a||(m=[p(u,"input",t[18]),p(u,"keypress",t[19])],a=!0)},p(t,n){128&n&&u.value!==t[7]&&h(u,t[7]),v===(v=w(t))&&g?g.p(t,n):(g.d(1),g=v(t),g&&(g.c(),g.m(c.parentNode,c)))},d(t){t&&l(n),t&&l(e),t&&l(u),t&&l(i),g.d(t),t&&l(c),a=!1,o(m)}}}function ot(n){let e,u,i,a,f,m;return{c(){e=s("div"),u=s("button"),u.textContent="Host",i=d(),a=s("button"),a.textContent="Join",w(e,"display","flex")},m(t,o){r(t,e,o),c(e,u),c(e,i),c(e,a),f||(m=[p(u,"click",n[14]),p(a,"click",n[14])],f=!0)},p:t,d(t){t&&l(e),f=!1,o(m)}}}function ut(n){let e,o;return{c(){e=a("Joining...\r\n                    "),o=s("div"),o.innerHTML='<div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div> \n                        <div class="svelte-7zu9yh"></div>',m(o,"class","lds-ellipsis svelte-7zu9yh")},m(t,n){r(t,e,n),r(t,o,n)},p:t,d(t){t&&l(e),t&&l(o)}}}function it(n){let e;return{c(){e=a("loading assets...")},m(t,n){r(t,e,n)},p:t,d(t){t&&l(e)}}}function ct(n){let e;function o(t,n){return t[2]?W:K}let u=o(n),i=u(n);return{c(){i.c(),e=f()},m(t,n){i.m(t,n),r(t,e,n)},p(t,[n]){u===(u=o(t))&&i?i.p(t,n):(i.d(1),i=u(t),i&&(i.c(),i.m(e.parentNode,e)))},i:t,o:t,d(t){i.d(t),t&&l(e)}}}function rt(){window.closeMenu()}function lt(t,n,e){let o,{setRoute:u}=n,{OPTIONS:i}=n,{inGame:c}=n,r=!1,l=!1;function s(){window.playMusic(),o&&w(),e(5,o=!1)}let a,d=new URLSearchParams(location.search),f=d.get("pieUrl"),p=d.get("game");function m(){e(8,a=window.pie.isConnected()),e(3,r=!1)}function h(){if(f){console.log("Menu: Connect to server",f),e(3,r=!0);const t=new URL(location.href);return t.searchParams.set("pieUrl",f),window.history.pushState(null,null,t),window.connect_to_wsPie_server(f).then(m)}return Promise.reject("No wsUrl defined to connect to")}function w(){window.pie.disconnect().then(m)}function v(){p?window.pie.isConnected()?(console.log("Menu: Connect to game name",p),e(4,l=!0),window.joinRoom({name:p}).then((()=>{const t=new URL(location.href);t.searchParams.set("game",p),window.history.pushState(null,null,t)})).catch((t=>{console.error("Could not join room",t)})).then((()=>{e(4,l=!1)}))):console.error("Cannot join room until pieClient is connected to a pieServer"):console.log("Cannot join game until a gameName is provided")}window.tryAutoConnect=()=>{f&&(console.log("Menu: Start auto connect"),s(),h())};return t.$$set=t=>{"setRoute"in t&&e(0,u=t.setRoute),"OPTIONS"in t&&e(1,i=t.OPTIONS),"inGame"in t&&e(2,c=t.inGame)},[u,i,c,r,l,o,f,p,a,function(){window.playMusic(),e(5,o=!0),window.startSingleplayer().then((()=>{m()}))},s,h,w,function(){if(confirm("Are you sure you want to quit to Main Menu?")){const t=new URL(location.href);t.searchParams.delete("game"),t.searchParams.delete("pieUrl"),window.history.pushState(null,null,t),window.exitCurrentGame().then(m)}},v,()=>u(i),function(){f=this.value,e(6,f)},t=>{"Enter"==t.key&&h()},function(){p=this.value,e(7,p)},t=>{"Enter"==t.key&&v()}]}class st extends H{constructor(t){super(),B(this,t,lt,ct,i,{setRoute:0,OPTIONS:1,inGame:2})}}function at(n){let e,u,i,a,f,h,w,v;return{c(){e=s("div"),u=s("button"),u.textContent="Resume Tutorial",i=d(),a=s("button"),a.textContent="Options",f=d(),h=s("button"),h.textContent="Skip Tutorial",m(e,"class","list")},m(t,o){r(t,e,o),c(e,u),c(e,i),c(e,a),c(e,f),c(e,h),w||(v=[p(u,"click",ft),p(a,"click",n[2]),p(h,"click",dt)],w=!0)},p:t,i:t,o:t,d(t){t&&l(e),w=!1,o(v)}}}function dt(){confirm("Are you sure you want to skip the tutorial?")&&(window.skipTutorial(),window.exitCurrentGame())}function ft(){window.closeMenu()}function pt(t,n,e){let{OPTIONS:o}=n,{setRoute:u}=n;return t.$$set=t=>{"OPTIONS"in t&&e(0,o=t.OPTIONS),"setRoute"in t&&e(1,u=t.setRoute)},[o,u,()=>u(o)]}class mt extends H{constructor(t){super(),B(this,t,pt,at,i,{OPTIONS:0,setRoute:1})}}function ht(n){let e,o;return e=new mt({props:{setRoute:n[3],OPTIONS:$t}}),{c(){U(e.$$.fragment)},m(t,n){j(e,t,n),o=!0},p:t,i(t){o||(E(e.$$.fragment,t),o=!0)},o(t){G(e.$$.fragment,t),o=!1},d(t){A(e,t)}}}function wt(t){let n,e;return n=new Y({props:{setRoute:t[3],lastRoute:t[0]}}),{c(){U(n.$$.fragment)},m(t,o){j(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.lastRoute=t[0]),n.$set(o)},i(t){e||(E(n.$$.fragment,t),e=!0)},o(t){G(n.$$.fragment,t),e=!1},d(t){A(n,t)}}}function vt(t){let n,e;return n=new st({props:{setRoute:t[3],OPTIONS:$t,inGame:t[2]}}),{c(){U(n.$$.fragment)},m(t,o){j(n,t,o),e=!0},p(t,e){const o={};4&e&&(o.inGame=t[2]),n.$set(o)},i(t){e||(E(n.$$.fragment,t),e=!0)},o(t){G(n.$$.fragment,t),e=!1},d(t){A(n,t)}}}function gt(t){let n,e,o,u;const i=[vt,wt,ht],c=[];function s(t,n){return t[1]==yt?0:t[1]==$t?1:t[1]==bt?2:-1}return~(n=s(t))&&(e=c[n]=i[n](t)),{c(){e&&e.c(),o=f()},m(t,e){~n&&c[n].m(t,e),r(t,o,e),u=!0},p(t,[u]){let r=n;n=s(t),n===r?~n&&c[n].p(t,u):(e&&(z(),G(c[r],1,1,(()=>{c[r]=null})),I()),~n?(e=c[n],e?e.p(t,u):(e=c[n]=i[n](t),e.c()),E(e,1),e.m(o.parentNode,o)):e=null)},i(t){u||(E(e),u=!0)},o(t){G(e),u=!1},d(t){~n&&c[n].d(t),t&&l(o)}}}const $t="OPTIONS",yt="PLAY",bt="TUTORIAL";function kt(t,n,e){let o,u;console.log("Menu: Svelte menu is running");let i=!1;function c(t){console.log("Menu: Route:",t),e(0,o=u),e(1,u=t),window.updateInGameMenuStatus()}return window.updateInGameMenuStatus=()=>{e(2,i=void 0!==window.underworld)},c(yt),window.setMenu=c,[o,u,i,c]}return new class extends H{constructor(t){super(),B(this,t,kt,gt,i,{})}}({target:document.getElementById("menu-inner")||document.body,props:{}})}();
//# sourceMappingURL=svelte-bundle.js.map
