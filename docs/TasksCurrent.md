## Schedule
- Pack 2 | Prevent hang on await
        - Possible causes
            - forceMoveInstances
            - fly() - flying / lobbing projectiles
            - createLevel
            - initLevel
            - animateSpell
            - playComboAnimation
            - playAnimation
            - addOneOffAnimation
            - moveTowards
            - resolveDoneMoving
            - unit.action
    - **critical** Brad's game got stuck on Message Type 9 Couldn't pick an upgrade
        - Develop a way of better logging where it's hanging
    - Could use Promise.race and a timeout wrapper as a bandaid to make sure game never hangs and reports where it would have
- Pack 4
    - **critical** Figure out how to broadcast player movement (due to the new system) to multiple clients
    - Server should be able to send syncs that will wait to execute until turn changes so it doesn't interrupt animations and mess up the state when it syncs
    - Add "preparing" animation used to reduce desyncs due to network latency, so that if multiple users are casting spells at the same time, the wizard bending down to "charge" as soon as the current user clicks, masks a delay to make sure it doesn't conflict with other spells.  It'll send the spell over the network as soon as the user clicks but waits to cast it so that there aren't conflicting spells making desyncs on multiple clients.
- Pack 5
    - Fix: bad-pathing.mkv in videos folder
        - seed: 0.6450583331398443
    - cloned self doesn't show magic animation when they cast
    - priest is attacking /dealing damage to him but he's not a vamp. how?
    - can't drag spell from book to toolbar if it's already in toolbar
- Pack 6
    - Standalone Server
        - Decouple the various layers (data: underworld; networking: pie; visual: Pixi / DOM; audio)
            - Then improve syncing strategy between the data layer and the visual layer.  This will be useful for network syncs, saves and loads, standalone headless server.
                - It should also solve the disappearing subsprite bug and the wizard robes changing color bug.
            - In order to decouple, each should have imports only in one file that can be dependency injected.  So ALL pie stuff goes through the networking layer, all DOM stuff goes through the UI layer, all PIXI (including PixiUtils which is how a lot of the files interact with PIXI) stuff goes through the pixi layer.  This should make it easy to make a headless server or make tests that use a data-only underworld
- Pack 7
    - Unit Crowding
        - `// TODO: Temp removed aliveNPCs because moveWithCollisions doesn't consider them yet`
    - casting non-curses like heal or purify on self should show green, not red
    - pathfinding for vampires broken?
    - Priest "run away" ai is broken / Archer pursue ai is not working well


- Pack 8
    - all SFX
        - all spells
        - Fall in lava
        - use potion
        - die
    - Master Music
- Pack 9 | R, J & E feedback
    - Song should loop until level changes
    - No stamina bar after portal
    - Freeze spell should stop timer on pickups
    - if a pickup says 1 it should last one more turn, not disappear next turn
    - animated trim path line for archers so it's obvious they'll hit you
    - Different attack icon for ranged units
    - Bug: No death circle for pushing units into liquid
    - Bug: Repel didn't work when R cast it directly on enemy, only worked when she clicked on empty ground
    - Said "out of range" for pickup but it's highlight underline was under the cursor 
        - Make their selection radius bigger! (same for units too), never disappoint the player, if the mouse reaches any part of a unit they should be selectable
    - Got "-60" mana when it should have been 0 when cursor wasn't on a target or was off the map
    - Hover should always show tooltip so you can see even when spell is queued
    - Bug: decoy died and archer changed targets, make units commit to a target at the beginning of the round, else PLAYER FRUSTRATION
    - shield should have number on it
    - Poison prediction is confusing
    - describe that decoy has health in card
    - Spike highlight is not visible
    - ideas
        - Have push and pull from the start
        - Takes too long to be fun, speed it up!!! 
        - objects to hide behind (raise earth)
        - More objects to interact with
        - Spell: grappling hook (pulls your towards something)
        - freezable liquid to walk over
        
        


- Ordered next tasks
    - Steam Page
    - Trailer
    - Marketing
## Bugs
- Self clones will walk through lava
- It's possible for a unit to "fall in" to lava and then to "fall out" immediately back on to ground depending on their position
- Pack 7: Dad Loch playtest
    - (resolved?) Make health and mana go full when portal spawns so users aren't tempted to collect potions meaninglessly
    - Explain to user with popups
        - Introduce card pickup
        - explain manaburn better
    - AI should avoid traps when moving
    - should "explode" be able to stack?
    - decoy should pull agro even if farther away?
    - Flag things visually as modifiers (loch says explode is confusing)
    - death circle can be confusing when moved out of the way of the toolbar (add arrow?)
    - Introduce mana cost changing of cards when used
    - error: cannot animation a still image (explode-on-death.png)
---
- Make combo wait for full completion so it doesn't change sprite to idle after resolving.
    - This makes it so that when casting two spells in quick succession, the second attack animation gets overridden by returningToDefaultSprite
- How to keep syncronize from interrupting an animation while it's running
    - Hold on to syncronize messages until a good time to execute them
- (resolved?) Pathing is broken sometimes where a unit moves a little and then no further
- enter, enter doesn't make "are you sure" prompt go away when there are no enemies.
- wall: see abberant-wall.png
- Bug: Portal spawns when you prediction kill yourself on test level
- Bug: Should sync portals when syncing units if all enemies are dead
- Bug: (Note: this is probably fixed now) Goons spawned outside of map when summoner was stuffed in upper left corner of map
- Bug: RMB hold on toolbar moves character.  Be very careful when solving this to ensure you don't make clicks in the invisible part of UI elements no longer work
---
## Features
- Archers on level 2 have more health than archers on level 1
    - This is because unit strength gradually increases, how to communicate this?
- Change contageous so it only spreads curses once instead of permanently?
    - This would solve the "infinite freeze" issue
- Use summoner magic animation for units that are summoned
- What if potions drop from slain enemies instead of being just pickups on the ground, it would be more exciting if you needed one and it dropped.
- Task: An ally that has died at all (even if ressed) should lose their upgrade priviledge
- SOUND: Organize candidates for sfx
- Allow pickups to be stored in inventory
- Show modifiers in UI somehow, not just on player, especially when you have the modifier on you
## UI
- death skull due to poison is confusing
- Draw walls above units so their corpses don't render over top of the walls
- Make damage that they WILL take different from damage that they HAVE taken.  It's confusing
## Stretch Content
- Cannot be combined with other spells
    - Jump card- to jump over walls
    - card to temporarily increase cast range
- vortex card - to pull units in to a center location
- Content: Time crystal releases something when it breaks
- Content: An enemy that pulls you into danger
- Content: "Orge" enemies that get stronger for every ally of theirs that dies
- An enemy that consumes allies to get stronger
- Specific barriers or walls that can't be cast through
- Content: A spell to destroy corpses
- task: Spell to trade mana for stamina
- idea; one use bargains (deals with the devil) that mix up your max stats.  or have a50% chance of good or bad outcome
- Leave blood trails behind for dead units that are force pushed

## Misc
- Bug: Had a scenario where i had a debugger on enterPortal and on image.show
and 2nd client got `Cannot change character, player not found with id 8c502be8-631c-482a-9398-40155f77c21f`
    - maybe in this case, re-request player sync??
- **critical** Improve sending castCards with targeting based on id not position
- (wont do?) Make an overlay screen that blocks interaction while waiting for sync
- Unit movement desync occurred between clients when one client has CPU throttled, the non throttled client has the unit move much farther
- fix grey ellipse positioning under lobber, it's too low