
- Desync will occur if:
  - Two tabs on character select (make sure you view both tabs once)
  - tab 1, choose character, vote level, do a bunch of actions
  - tab 2, choose character, (BUG) it then goes to vote level, but the game is already in play
  - it should just load the current gamestate
    - This can also happen when the HOST (who sends LOAD_GAME_STATE) remains on character select while someone else starts the game
- Here's a desync question: How do I connect a client to the server before they become a "player" in the game. (e.g. before they choose a character on the character select screen)
- Desync occurred where I connected two clients (both at the character select), I chose a character on #1, and chose a level, the level spawned in. Then I chose a character on #2 and chose a DIFFERENT level and they both spawned in but the levels looked different even though it said altitude one for both and the RNG had the same state
- Desync where if one client misses a `clientPresenceChanged` message their game will continue to operate as if that client isn't connected and can't take turns.
  - AHA, I think due to the fake lag, clients messages MAY arrive out of order
- I was able to cause a desync, by makings a 5 second lag for messages, having two clients in the same window on different tabs and moving one while the other's message was still in flight
- Was able to cause a `window.overworld is undefined` in overworld.js:27 voteForLevel by having the two tabs start loading then having one vote before the other was finished. Now the overworld is going away in favor of the cauldron, but I should keep this kind of bug in mind when expecting users to join at any stage of the game
- Ideas 2021-12-17
  - (L) Mana Update
    - (M) Cost mana for each card and the farther away you cast so there is no range limit (this allows for more strategy, more tradeoffs)
    - (S) Never run out of cards, you're limited by mana instead (this way you don't get stuck)
      - Update Card management, how do you get new cards now?
    - (S) New cards for mana, mana potions
  - (L) Get rid of cells / Allow free movement
    - This might make judgements about AI danger more dynamic and less boring and mathematical
    - This may simplify movement code as it relates to units getting in each others way
    - Update pathing
    - Cast spells with base radius, or on nearest enemy or cursor?
    - (S) Lots of little bad guys, some big ones; Smaller units visually
  - (S) Heros have much more health, bad guys die more quickly, getting hit isn't as big of a deal, so you don't have to worry about overcalculating agro range, you can be more **intuitive** in your play.
  - (s) Categories of spells, the combinable ones (cards), the special spells (teleport and such) limited in use - represent them differently (with, say, a hexagon, for the ones that can get used up)
    - Make these pickupable (call them runes?) and they persist between levels
  - (L) Rather than an overworld, what if you and your team have to mix potions in a cauldron to create a portal that leads you to a unique level? (The cauldron makes the portal)
    - This adds another tradeoff, the more dangerous the portal, the greater the reward for surviving it.
    - Should cauldron have bounds so players can't under do the difficulty or over do it?
    - Should there be a time constraint for end game? so you can only make so many culdrons?
    - In the boss battle, maybe you need to protect the culdron and there's no portal?
- (M) wsPie: how to handle reconnection
  1. Reconnection when the server goes down and comes back up (loses room state)
  2. Reconnection when the client goes down and comes back up (keeps room?)
  - How to handle user joining mid stage (say during overworld or during underworld)?
- More spells:
  - Vanish (loses agro) (invisible for x number of turns) "creating separation"
  - Taunt (gain agro)
- Improve / Fix Spells:
  - What happens when you clone yourself?
  - Charge doesn't play well with AOE
  - chain purify didn't work(didn't remove poison)
